<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>焦点轮播图</title>
  <style type="text/css">
    /*去除内边距,没有链接下划线*/
    * {
      margin: 0;
      padding: 0;
      text-decoration: none;
    }

    /*让<body有20px的内边距*/
    body {
      padding: 20px;
    }

    /*最外围的div*/
    #container {
      width: 600px;
      height: 400px;
      overflow: hidden;
      position: relative; /*相对定位*/
      margin: 0 auto;
    }

    /*包含所有图片的<div>*/

    #list {
      width: 4200px; /*7张图片的宽: 7*600 */
      height: 400px;
      position: absolute; /*绝对定位*/
      z-index: 1;

    }

    /*所有的图片<img>*/
    #list img {
      float: left; /*浮在左侧*/
    }

    /*包含所有圆点按钮的<div>*/
    #pointsDiv {
      position: absolute;
      height: 10px;
      width: 100px;
      z-index: 2;
      bottom: 20px;
      left: 250px;
    }

    /*所有的圆点<span>*/

    #pointsDiv span {
      cursor: pointer;
      float: left;
      border: 1px solid #fff;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #333;
      margin-right: 5px;
    }

    /*第一个<span>*/

    #pointsDiv .on {
      background: orangered;
    }

    /*切换图标<a>*/

    .arrow {
      cursor: pointer;
      display: none;
      line-height: 39px;
      text-align: center;
      font-size: 36px;
      font-weight: bold;
      width: 40px;
      height: 40px;
      position: absolute;
      z-index: 2;
      top: 180px;
      background-color: RGBA(0, 0, 0, 0.3);
      color: #fff;
    }

    /*鼠标移到切换图标上时*/
    .arrow:hover {
      background-color: RGBA(0, 0, 0, 0.7);
    }

    /*鼠标移到整个div区域时*/
    #container:hover .arrow {
      display: block; /*显示*/
    }

    /*上一个切换图标的左外边距*/
    #prev {
      left: 20px;
    }

    /*下一个切换图标的右外边距*/
    #next {
      right: 20px;
    }
  </style>

  <script src="../jQuery.js"></script>
  <script>
    $(function(){
      var $container = $("#container");
      var $list = $("#list");
      var $points = $("#pointsDiv > span");
      var $prev = $("#prev");
      var $next = $("#next");
      var TIME = 400;
      var ITEM_TIME = 20;
      var PAGE_WIDTH = 600;
      var imgCount = $points.length;
      var index = 0;
      var moving =  false;



      $prev.click(function(){
        nextPage(false);  
      });

      $next.click(function(){
        nextPage(true);
      });

      var intervalID = setInterval(function(){
        nextPage(true);
      },1000);

      $container.hover(
        function(){
          clearInterval(intervalID);
        },
        function(){
            intervalID = setInterval(function(){
            nextPage(true);
          },1000);
        }
      );

      $points.click(function(){
        var target_index = 0;
        target_index = $(this).index();
        if(index != target_index){
          nextPage(target_index);
        }
      });

      function nextPage(next){
        if(moving){
          return;
        }

        moving = true;
        var offset = 0;
        
        if(typeof next === "boolean"){
          offset = next ? -PAGE_WIDTH : PAGE_WIDTH;
        }else{
          offset = (index-next)*PAGE_WIDTH;
        }
        
        var item_offset = offset/(TIME/ITEM_TIME);
        var currentLeft = $list.position().left;
        var target_left = currentLeft+offset;

        var intervalID = setInterval(function(){
          
          currentLeft += item_offset;
          if(currentLeft === target_left){
            clearInterval(intervalID);
            moving =  false;
            if(currentLeft === -(imgCount+1)*PAGE_WIDTH){
              currentLeft = -PAGE_WIDTH;
            }else if(currentLeft === 0){
              currentLeft = -imgCount*PAGE_WIDTH;
            }

          }
          $list.css("left", currentLeft);
          

        },ITEM_TIME)
        
        updatePoints(next);
      }

      function updatePoints(next){
        var target_index = 0;
        
        if(typeof next === "boolean"){
          if(next){
            target_index = index + 1;
            if(target_index === imgCount){
              target_index = 0;
            }
          }else{
            target_index = index - 1;
            if(target_index === -1){
              target_index = imgCount-1;
            }
          }
        }else{
          target_index = next;
        }

        $points.eq(index).removeClass("on");
        $points.eq(target_index).addClass("on");

        index = target_index;

      }


    })
  </script>

</head>

<body>

<div id="container">
  <div id="list" style="left: -600px;">
    <img src="img/5.jpg" alt="5"/>
    <img src="img/1.jpg" alt="1"/>
    <img src="img/2.jpg" alt="2"/>
    <img src="img/3.jpg" alt="3"/>
    <img src="img/4.jpg" alt="4"/>
    <img src="img/5.jpg" alt="5"/>
    <img src="img/1.jpg" alt="1"/>
  </div>
  <div id="pointsDiv">
    <span index="1" class="on"></span>
    <span index="2"></span>
    <span index="3"></span>
    <span index="4"></span>
    <span index="5"></span>
  </div>
  <a href="javascript:;" id="prev" class="arrow">&lt;</a>
  <a href="javascript:;" id="next" class="arrow">&gt;</a>
</div>


</body>

</html>